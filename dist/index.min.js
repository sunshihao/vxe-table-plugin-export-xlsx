function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define("vxe-table-plugin-export-xlsx-xhx",["exports","xe-utils","xlsx-js-style"],t):"undefined"!=typeof exports?t(exports,require("xe-utils"),require("xlsx-js-style")):(t((t={exports:{}}).exports,e.XEUtils,e.xlsxJsStyle),e.VXETablePluginExportXLSX=t.exports.default)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,d,y){"use strict";var b;function s(e){var t,o;return"function"!=typeof WeakMap?null:(t=new WeakMap,o=new WeakMap,(s=function(e){return e?o:t})(e))}function t(e){var n=e.$table,t=e.options,r=e.columns,e=e.datas,o=t.sheetName,i=t.isHeader,s=t.isFooter,a=t.original,l=t.message,u=t.footerFilterMethod,f={},c=[],e=(i&&r.forEach(function(e){f[e.id]=d.default.toString(a?e.property:e.getTitle())}),e.map(function(t){var o={};return r.forEach(function(e){o[e.id]=function(e,t){if(t)switch(e.cellType){case"string":return d.default.toString(t);case"number":if(isNaN(t))break;return Number(t);default:if(t.length<12&&!isNaN(t))return Number(t)}return t}(e,t[e.id])}),o})),u=(s&&(s=n.getTableData().footerData,(u?s.filter(u):s).forEach(function(t){var o={};r.forEach(function(e){o[e.id]=d.default.toString(t[n.$getColumnIndex(e)])}),c.push(o)})),y.utils.book_new()),p=y.utils.json_to_sheet((i?[f]:[]).concat(e).concat(c),{skipHeader:!0}),s=(Object.keys(p).forEach(function(e){e.startsWith("!")||("1"===e.replace(/[^\d]/g,"")?(p[e].v=p[e].v.padEnd(10," "),p[e].s={font:{sz:"10",bold:!0},fill:{fgColor:{rgb:"F2F2F2"}},border:{top:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"}}}):p[e].s={font:{sz:"10"},alignment:{wrapText:!0,vertical:"top"},border:{top:{style:"thin"},right:{style:"thin"},bottom:{style:"thin"},left:{style:"thin"}}})}),y.utils.book_append_sheet(u,p,o),y.write(u,{bookType:"xlsx",bookSST:!1,type:"binary"})),i=new Blob([function(e){for(var t=new ArrayBuffer(e.length),o=new Uint8Array(t),n=0;n!==e.length;++n)o[n]=255&e.charCodeAt(n);return t}(s)],{type:"application/octet-stream"}),e=t;window.Blob?(o=e.filename,e=e.type,navigator.msSaveBlob?navigator.msSaveBlob(i,"".concat(o,".").concat(e)):((u=document.createElement("a")).target="_blank",u.download="".concat(o,".").concat(e),u.href=URL.createObjectURL(i),document.body.appendChild(u),u.click(),document.body.removeChild(u))):console.error(b.t("vxe.error.notExp")),!1!==l&&b.modal.message({message:b.t("vxe.table.expSuccess"),status:"success"})}function f(e){return e.replace(/^"/,"").replace(/"$/,"")}function o(e){var s=e.columns,a=e.options,t=e.file,l=e.$table,u=l._importResolve,e=new FileReader;e.onload=function(e){var n,t,o,r,e=y.read(e.target.result,{type:"binary"}),e=y.utils.sheet_to_csv(e.Sheets.Sheet1),e=(e=(e=e).split("\n"),n=[],t=[],e.length&&(i=e.slice(1),e[0].split(",").map(f),i.forEach(function(e){var o;e&&(o={},e.split(",").forEach(function(e,t){n[t]&&(o[n[t]]=f(e))}),t.push(o))})),{fields:n,rows:t}),i=e.rows,e=(o=e.fields,r=[],s.forEach(function(e){e=e.property;e&&r.push(e)}),r.every(function(e){return o.includes(e)}));e?(l.createData(i).then(function(e){"append"===a.mode?l.insertAt(e,-1):l.reloadData(e)}),!1!==a.message&&b.modal.message({message:d.default.template(b.t("vxe.table.impSuccess"),[i.length]),status:"success"})):!1!==a.message&&b.modal.message({message:b.t("vxe.error.impFields"),status:"error"}),u&&(u(e),l._importResolve=null)},e.readAsBinaryString(t)}function n(e){if("xlsx"===e.options.type)return o(e),!1}function r(e){if("xlsx"===e.options.type)return t(e),!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExportXLSX=void 0,d=(i=d)&&i.__esModule?i:{default:i},y=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};t=s(t);if(t&&t.has(e))return t.get(e);var o,n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(o in e){var i;"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&((i=r?Object.getOwnPropertyDescriptor(e,o):null)&&(i.get||i.set)?Object.defineProperty(n,o,i):n[o]=e[o])}n.default=e,t&&t.set(e,n);return n}(y);var i={install:function(e){var t=e.interceptor;b=e,Object.assign(e.types,{xlsx:1}),t.mixin({"event.import":n,"event.export":r})}};e.VXETablePluginExportXLSX=i,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(i);e.default=i});