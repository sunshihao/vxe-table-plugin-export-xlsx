!function(e,t){"function"==typeof define&&define.amd?define("vxe-table-plugin-export-xlsx-xhx",["exports","xe-utils","xlsx"],t):"undefined"!=typeof exports?t(exports,require("xe-utils"),require("xlsx")):(t((t={exports:{}}).exports,e.XEUtils,e.XLSX),e.VXETablePluginExportXLSX=t.exports.default)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,d,p){"use strict";function t(e){return e&&e.__esModule?e:{default:e}}var m;function n(e){var o=e.$table,t=e.options,r=e.columns,e=e.datas,n=t.sheetName,a=t.isHeader,i=t.isFooter,s=t.original,l=t.message,u=t.footerFilterMethod,c={},f=[],e=(a&&r.forEach(function(e){c[e.id]=d.default.toString(s?e.property:e.getTitle())}),e.map(function(t){var n={};return r.forEach(function(e){n[e.id]=function(e,t){if(t)switch(e.cellType){case"string":return d.default.toString(t);case"number":if(isNaN(t))break;return Number(t);default:if(t.length<12&&!isNaN(t))return Number(t)}return t}(e,t[e.id])}),n})),u=(i&&(i=o.getTableData().footerData,(u?i.filter(u):i).forEach(function(t){var n={};r.forEach(function(e){n[e.id]=d.default.toString(t[o.$getColumnIndex(e)])}),f.push(n)})),p.default.utils.book_new()),i=p.default.utils.json_to_sheet((a?[c]:[]).concat(e).concat(f),{skipHeader:!0}),a=(p.default.utils.book_append_sheet(u,i,n),p.default.write(u,{bookType:"xlsx",bookSST:!1,type:"binary"})),e=new Blob([function(e){for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),o=0;o!==e.length;++o)n[o]=255&e.charCodeAt(o);return t}(a)],{type:"application/octet-stream"}),i=t;window.Blob?(n=i.filename,i=i.type,navigator.msSaveBlob?navigator.msSaveBlob(e,"".concat(n,".").concat(i)):((u=document.createElement("a")).target="_blank",u.download="".concat(n,".").concat(i),u.href=URL.createObjectURL(e),document.body.appendChild(u),u.click(),document.body.removeChild(u))):console.error(m.t("vxe.error.notExp")),!1!==l&&m.modal.message({message:m.t("vxe.table.expSuccess"),status:"success"})}function c(e){return e.replace(/^"/,"").replace(/"$/,"")}function o(e){var i=e.columns,s=e.options,t=e.file,l=e.$table,u=l._importResolve,e=new FileReader;e.onload=function(e){var o,t,n,r,e=p.default.read(e.target.result,{type:"binary"}),e=p.default.utils.sheet_to_csv(e.Sheets.Sheet1),e=(e=(e=e).split("\n"),o=[],t=[],e.length&&(a=e.slice(1),e[0].split(",").map(c),a.forEach(function(e){var n;e&&(n={},e.split(",").forEach(function(e,t){o[t]&&(n[o[t]]=c(e))}),t.push(n))})),{fields:o,rows:t}),a=e.rows,e=(n=e.fields,r=[],i.forEach(function(e){e=e.property;e&&r.push(e)}),r.every(function(e){return n.includes(e)}));e?(l.createData(a).then(function(e){"append"===s.mode?l.insertAt(e,-1):l.reloadData(e)}),!1!==s.message&&m.modal.message({message:d.default.template(m.t("vxe.table.impSuccess"),[a.length]),status:"success"})):!1!==s.message&&m.modal.message({message:m.t("vxe.error.impFields"),status:"error"}),u&&(u(e),l._importResolve=null)},e.readAsBinaryString(t)}function r(e){if("xlsx"===e.options.type)return o(e),!1}function a(e){if("xlsx"===e.options.type)return n(e),!1}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExportXLSX=void 0,d=t(d),p=t(p);var i={install:function(e){var t=e.interceptor;m=e,Object.assign(e.types,{xlsx:1}),t.mixin({"event.import":r,"event.export":a})}};e.VXETablePluginExportXLSX=i,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use(i);e.default=i});