function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(e,t){"function"==typeof define&&define.amd?define("vxe-table-plugin-export-xlsx",["exports","xe-utils","exceljs"],t):"undefined"!=typeof exports?t(exports,require("xe-utils"),require("exceljs")):(t((t={exports:{}}).exports,e.XEUtils,e.ExcelJS),e.VXETablePluginExportXLSX=t.exports.default)}("undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:this,function(e,M,$){"use strict";function l(e){var t,o;return"function"!=typeof WeakMap?null:(t=new WeakMap,o=new WeakMap,(l=function(e){return e?o:t})(e))}Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.VXETablePluginExportXLSX=void 0,M=(c=M)&&c.__esModule?c:{default:c},$=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==_typeof(e)&&"function"!=typeof e)return{default:e};t=l(t);if(t&&t.has(e))return t.get(e);var o,n={},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(o in e){var a;"default"!==o&&Object.prototype.hasOwnProperty.call(e,o)&&((a=r?Object.getOwnPropertyDescriptor(e,o):null)&&(a.get||a.set)?Object.defineProperty(n,o,a):n[o]=e[o])}n.default=e,t&&t.set(e,n);return n}($);var B="f8f8f9",P="606266",t="thin",o="e8eaec";function V(e,t){if(t)switch(e.cellType){case"string":return M.default.toValueString(t);case"number":if(isNaN(t))break;return Number(t);default:if(t.length<12&&!isNaN(t))return Number(t)}return t}function N(e,t){t&&(e.height=M.default.floor(.75*t,12))}function R(e,t){e.protection={locked:!1},e.alignment={vertical:"middle",horizontal:t||"left"}}function A(){return{top:{style:t,color:{argb:o}},left:{style:t,color:{argb:o}},bottom:{style:t,color:{argb:o}},right:{style:t,color:{argb:o}}}}function n(i){function e(){var e=new $.Workbook,n=e.addWorksheet(h);e.creator="vxe-table",n.columns=O,b&&n.addRows(S).forEach(function(e){w&&N(e,l),e.eachCell(function(e){var t=n.getColumn(e.col),t=r.getColumnById(t.key),o=t.headerAlign,t=t.align;R(e,o||t||u||f),w&&Object.assign(e,{font:{bold:!0,color:{argb:P}},fill:{type:"pattern",pattern:"solid",fgColor:{argb:B}},border:A()})})}),n.addRows(X).forEach(function(e){w&&N(e,l),e.eachCell(function(e){var t=n.getColumn(e.col);R(e,r.getColumnById(t.key).align||f),w&&Object.assign(e,{font:{color:{argb:P}},border:A()})})}),m&&n.addRows(C).forEach(function(e){w&&N(e,l),e.eachCell(function(e){var t=n.getColumn(e.col),t=r.getColumnById(t.key),o=t.footerAlign,t=t.align;R(e,o||t||d||f),w&&Object.assign(e,{font:{color:{argb:P}},border:A()})})}),w&&E&&E({options:c,workbook:e,worksheet:n,columns:s,colgroups:t,datas:a,$table:r}),j.forEach(function(e){var t=e.s,e=e.e;n.mergeCells(t.r+1,t.c+1,e.r+1,e.c+1)}),e.xlsx.writeBuffer().then(function(e){var t,e=new Blob([e],{type:"application/octet-stream"}),o=c,n=(r=(r=i).$table.$vxe).modal,r=r.t,a=o.message,l=o.filename,o=o.type,a=!1!==a;window.Blob?navigator.msSaveBlob?navigator.msSaveBlob(e,"".concat(l,".").concat(o)):((t=document.createElement("a")).target="_blank",t.download="".concat(l,".").concat(o),t.href=URL.createObjectURL(e),document.body.appendChild(t),t.click(),document.body.removeChild(t)):a&&n&&n.alert({content:r("vxe.error.notExp"),status:"error"}),k&&p&&(p.close("xlsx"),p.message({content:g("vxe.table.expSuccess"),status:"success"}))})}var o,r=i.$table,c=i.options,s=i.columns,t=i.colgroups,a=i.datas,n=r.$vxe,l=r.rowHeight,u=r.headerAlign,f=r.align,d=r.footerAlign,p=n.modal,g=n.t,n=c.message,h=c.sheetName,b=c.isHeader,m=c.isFooter,y=c.isMerge,x=c.isColgroup,v=c.original,w=c.useStyle,E=c.sheetMethod,k=!1!==n,n=r.getMergeCells(),S=[],C=[],O=[],j=[],_=0,T={},X=(s.forEach(function(e){var t=e.id,o=e.property,n=e.renderWidth;T[t]=v?o:e.getTitle(),O.push({key:t,width:M.default.ceil(n/8,1)})}),b&&(x&&!v&&t?t.forEach(function(e,a){var l={};s.forEach(function(e){l[e.id]=null}),e.forEach(function(e){var t=e._colSpan,o=e._rowSpan,n=function e(t){var o=t.childNodes;return o&&o.length?e(o[0]):t}(e),r=s.indexOf(n);l[n.id]=v?n.property:e.getTitle(),(1<t||1<o)&&j.push({s:{r:a,c:r},e:{r:a+o-1,c:r+t-1}})}),S.push(l)}):S.push(T),_+=S.length),y&&!v&&n.forEach(function(e){var t=e.row,o=e.rowspan,n=e.col,e=e.colspan;j.push({s:{r:t+_,c:n},e:{r:t+_+o-1,c:n+e-1}})}),a.map(function(t){var o={};return s.forEach(function(e){o[e.id]=V(e,t[e.id])}),o}));_+=X.length,m&&(x=r.getTableData().footerData,n=x,x=(o=c.footerFilterMethod)?n.filter(function(e,t){return o({items:e,$rowIndex:t})}):n,n=r.getMergeFooterItems(),y&&!v&&n.forEach(function(e){var t=e.row,o=e.rowspan,n=e.col,e=e.colspan;j.push({s:{r:t+_,c:n},e:{r:t+_+o-1,c:n+e-1}})}),x.forEach(function(t){var o={};s.forEach(function(e){o[e.id]=V(e,t[r.getVMColumnIndex(e)])}),C.push(o)}));k&&p?(p.message({id:"xlsx",content:g("vxe.table.expLoading"),status:"loading",duration:-1}),setTimeout(e,1500)):e()}function d(e){var t=e.$table,e=e.options,o=t.$vxe,t=t._importReject,e=!1!==e.message,n=o.modal,o=o.t;e&&n&&n.message({content:o("vxe.error.impFields"),status:"error"}),t&&t({status:!1})}function r(a){var l=a.$table,o=a.columns,i=a.options,e=a.file,t=l.$vxe,c=l._importResolve,s=t.modal,u=t.t,f=!1!==i.message,t=new FileReader;t.onerror=function(){d(a)},t.onload=function(e){var r=[],t=(o.forEach(function(e){e=e.property;e&&r.push(e)}),new $.Workbook),e=e.target;e?t.xlsx.load(e.result).then(function(e){var t,n,o,e=e.worksheets[0];e&&(e=e.getSheetValues(),t=M.default.findIndexOf(e,function(e){return e&&0<e.length}),n=e[t],o=r,n.some(function(e){return-1<o.indexOf(e)}))?(e=e.slice(t).map(function(e){var o={},t=(e.forEach(function(e,t){o[n[t]]=e}),{});return r.forEach(function(e){t[e]=M.default.isUndefined(o[e])?null:o[e]}),t}),l.createData(e).then(function(e){e="insert"===i.mode?l.insertAt(e,-1):l.reloadData(e);return e.then(function(){c&&c({status:!0})})}),f&&s&&s.message({content:u("vxe.table.impSuccess",[e.length]),status:"success"})):d(a)}):d(a)},t.readAsArrayBuffer(e)}function a(e){if("xlsx"===e.options.type)return r(e),!1}function i(e){if("xlsx"===e.options.type)return n(e),!1}var c={install:function(e){var t=e.interceptor;e.setup({export:{types:{xlsx:0}}}),t.mixin({"event.import":a,"event.export":i})}};e.VXETablePluginExportXLSX=c,"undefined"!=typeof window&&window.VXETable&&window.VXETable.use&&window.VXETable.use(c);e.default=c});